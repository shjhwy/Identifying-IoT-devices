# Abstract

识别隐藏在NAT后面传播恶意行为的主机对于取证调查是必要的。在本文中，我们提出了一种基于机器学习（ML）的算法来**识别和计算NAT背后的主机总数**。这是通过在网络流量中通过**流量级别的统计识别模式**和**检测主机的匿名性**来实现的。拟议工作的新颖之处在于**计算主机数目**，并将结果与**传统的基于签名的方法**进行比较，大大超过了基于签名的方法结果（约75%）。

此外，该模型还通过向其提供恶意网络流量数据集进行测试，以**识别和计算流量是来自于单个还是多个主机**。获得的较高准确率（约92.2%）反映了**该模型能够预测和计算正确的恶意主机数量**，且误报率最低。

我们通过在统计网**流记录**上应用基于ML的技术来识别和计算NAT背后的主机数量。所提出的方法的优点是，在捕获头的时候不会出现与**隐私**有关的问题。

# 简介

**动机**

这项工作的动机是开发一个ML模型，以识别NAT设备后面的主机（ identifies the hosts behind NAT device），并帮助计算它们（counting them）。

**NAT带来的挑战**

最大的问题是识别隐藏在NAT设备的公共接口后面的单个主机，每一次试图从广域网（WAN）找到攻击源，都会把他们引向网络网关（NAT）的公共接口，这就成为检测源的瓶颈。**在没有网络管理员的帮助下**，要进一步检测和找到确切的主机是**不可能**的。

**主机识别的需要**

ISP需要知道NAT后面的活跃用户的数量，以确保他们不跨越付费用户连接配额。

流媒体服务器，也需要主机计数以更好地服务其用户，在NAT用户的情况下，一个用户请求（隐藏大量的匿名用户）可能会用实时流协议（RTSP）请求压倒服务器。这可能会模仿DOS攻击，而用户数对于此类服务是至关重要的。

**论文贡献**

目前应用的传统的基于ML的方法是从网络流量中检测rouge NAT或NAT设备（is to detect rouge NAT or NAT device from network traffic）。

到目前为止，**尚未对主机进行计数**。本文提出了一种基于ML的算法来**识别和计算NAT后的主机总数**。这是通过**流级别统计来查找网络流量模式**，并**检测主机的匿名性**来实现的。所提出的工作的**新颖之处在于计算NAT背后的主机总数**，并将其结果**与基于签名的最先进方法进行比较**。

1. 使用提议的基于ML的方法**识别和计算隐藏在NAT后面的主机总数**。
2. 用恶意主机数据集来**计算恶意主机的数量**。这将有助于在检测到恶意流量的情况下，但我们不知道它是来自单个主机还是多个主机。
3. 与其他最先进的技术进行比较分析，以确定该模型的功效。

因此，当前工作的目标是开发一个ML模型，该模型可以**很容易地检测到NAT设备后面的主机（在私人局域网中），并帮助计算主机的总数**。这种模型的意义在于，根据网络流量的模式，**利用流量级别的统计数据，准确预测主机的匿名性。**（accurately predict the anonymity of hosts）

# 相关工作

主机识别技术--主机检测--主要可以通过两种方法实现，即主动探测或被动探测。

被动技术又被分为**基于签名**的方法和**基于ML**的方法。

基于签名的技术用于检测NAT后面的主机，就是要找到一组参数（签名），使得在没有IP地址的情况下**可以唯一地定义主机**。

- Cohen[7]提出了一个模型，使用不同协议字段之间的相关性来识别源机器；
- Maier等人[8]使用IP TTL和HTTP用户代理字符串来估计连接到NAT设备的主机数量；
- Mongkolluksamee等人[9]提出了一个被动方法来计算具有类似IP地址的主机，即NAT设备；
- Wicherski等人[10]提出了一个轻量级的实时灵活框架NATFILTERED，它使用**时间戳（TCP）来识别主机而不依赖于IP地址**；
- Paul等人[11]提出了一种**基于TCP SYN的方法来识别虚拟机**（VM）环境中使用的未授权操作系统的恶意活动；
- Park等人[12]提出了一种技术，使用**TCP/IP协议的头域来检测NAT背后的全部主机及其操作系统类型**。

表1详细显示了对基于ML的方法检测NAT和它背后的主机所做的文献调查。