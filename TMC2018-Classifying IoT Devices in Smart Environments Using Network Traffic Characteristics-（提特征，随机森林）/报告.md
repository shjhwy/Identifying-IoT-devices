地址：https://ieeexplore.ieee.org/abstract/document/8440758

# 简介

## 意义

运营商可能会发现很难确定哪些物联网设备连接到他们的网络。测和缓解网络安全攻击。众所周知，物联网设备本质上和设计易于渗透[7]，[8]，[9]，[10]，[11]，[12]。关于物联网设备如何受到损害并用于发动大规模攻击的新故事正在出现[13]。物联网设备中的巨大异构性促使研究人员提出了网络级安全机制，可以分析流量模式以识别攻击（参见[14]和我们最近的工作[15]）;这些方法的成功取决于对“正常”IoT流量配置情况的良好理解。



为什么MAC前缀和DHCP的host name字段识别设备不行：

（a）物联网设备制造商通常使用第三方供应商提供的NIC，因此MAC地址的组织唯一标识符（OUI）前缀可能无法传达有关物联网设备的任何信息;（b） MAC地址可能被恶意设备欺骗;（c） 许多物联网设备在其 DHCP 请求中未设置主机名选项（d）即使物联网设备公开其主机名，它可能并不总是有意义的；（e）这些主机名可以由用户更改

## 工作

从网络流量派生的统计特征，包括：activity cycles, port numbers, signaling patterns and cipher suites

定性而言，大多数物联网设备**预计会偶尔发送短突发数据**。（short bursts）。第一次尝试研究物联网设备在burst中发送多少流量以及它们在活动之间空闲多长时间。

28个不同物联网设备的，捕获6个月

# 流量收集

![Fig. 1. -  Testbed architecture showing connected 28 different IoT devices along with several non-IoT devices, and telemetry collected across the infrastructure is fed to our classification models. ](../../实验截图/habib1-2866249-small.gif)



详见：D:\Documents\shj\胡伟业我的\iie\开题（答辩后）\开做研究点一\数据集汇总.md

数据集特点：

**在LAN上捕获**流量允许我们使用MAC地址作为设备的标识符，以将其流量与包含网络中许多其他设备的流量组合隔离开来。

# 流量表征

活动模式（例如，活动/睡眠期间的数量/时间分布）和信令（例如，请求的域名，使用的服务器端端口号和TLS握手交换）

```
activity patterns (e.g., distribution of volume/times during active/sleep periods), and signalling (e.g., domain names requested, server-side port numbers used and TLS handshake exchanges).
```

## 流级别的Activity and Volume Pattern

四个属性：

流量（即下载和上传字节的总和）、流量持续时间（即流中第一个和最后一个数据包之间的时间）、平均流量（即流量除以流量持续时间），以及设备睡眠时间（即，物联网设备没有活动流的时间间隔）

证据：

1. 物联网设备**倾向于在每个流中交换少量数据**，比如设备Amazon Echo超过 95% 的流传输的字节数少于 1000 字节
2. 物联网设备的**一条流的持续时间较短**，Amazon Echo超过40%的流中可以看到53秒的流持续时间
3. 40% 的 Amazon Echo 流的比特率范围在 70 到 71 位/秒之间
4. 贝尔金运动传感器和LiFX灯泡表现出明显的睡眠模式。持续时间为 1 秒和 60 秒，概率分别为 73% 和 48%。但是，Amazon Echo观察到多个小概率的睡眠时间。这是因为 Amazon Echo 保持其 TCP 连接处于活动状态，并且只有在与 Internet 断开连接时才进入睡眠状态。

## 应用层字段的Signaling Pattern

专注于应用层协议，从端口号推断物联网设备主要用于在LAN中本地通信和/或外部与公共Internet上的服务器进行通信。

#### 服务器端口号

物联网设备每个都与少数服务器端口唯一通信，而非物联网设备使用更广泛的服务（即，图4h中显示了2382个唯一端口）

许多物联网设备以及具有不同频率的非物联网设备都使用众所周知的标准端口号，如53（DNS）、123（NTP）、0（ICMP）和1900（SSDP）。此外，服务器端端口号443（TLS / SSL）也被许多物联网设备使用。

#### DNS查询

物联网设备可以通过其通信的域名进行区分。我们看到大约12000个访问了独特的域，与只有少数几个域重复访问的物联网设备相比，这是非常多样化的。

#### NTP查询

许多物联网设备倾向于定期使用NTP协议（UDP端口123），以便将其时间与公开可用的NTP服务器同步。

#### TLS/SSL密码套件

“Client Hello”数据包，该数据包包含它们可以支持的“密码套件”列表，按其首选项顺序排列。每个密码套件（即4位代码）可以采用380个可能值之一，并表示密钥交换，批量加密和消息身份验证代码（MAC）的算法。例如，Amazon 服务器协商的密码 002f 分别使用 RSA、AES_128_CBC 和 SHA 协议。

28个物联网设备中，有17个，使用 TLS/SSL 进行通信。

有许多设备很少交换密码套件，而是更喜欢长时间保持其TLS连接处于活动状，Google Dropcam在启动时都会与其自己的服务器建立TLS连接，只要它具有网络连接，它就会保持此连接。像密码套件列表这样的强属性在流量中很少被观察到（例如，每天只一次）

#### 总结

确定了8个关键属性。它们是流量、流量持续时间、平均流速、设备休眠时间、服务器端口号、DNS 查询、NTP 查询和密码套件。在下一节中，我们将使用这些属性的组合开发一种基于多阶段机器学习的算法，以帮助对物联网设备进行高精度分类。

# 基于机器学习的分类

首先用joy从pcap中生成流，然后从每一个小时内的流量计算上一节中定义的流量活动和信令属性，得到实例。共26周的流量。

对于形式化的特征，如：“域名集”，“远程端口号集”和“密码套件集”，分别生成离散属性的bags，分别送入朴素贝叶斯多项式分类器为这三个bag进行分类，输出为对应的类别标签和可信度confidence。再将这两个值和前面如流量等数字特征组合在一起送入随机森林模型。
