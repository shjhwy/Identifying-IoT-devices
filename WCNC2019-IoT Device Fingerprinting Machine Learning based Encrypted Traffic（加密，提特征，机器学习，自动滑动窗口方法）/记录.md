地址：[IoT Device Fingerprinting: Machine Learning based Encrypted Traffic Analysis | IEEE Conference Publication | IEEE Xplore](https://ieeexplore.ieee.org/abstract/document/8885429)

# 摘要

在本文中证明，攻击者能够通过识别物联网流量中的特定模式来泄露有关物联网设备的敏感信息，例如其类型。

# 介绍

揭示**物联网设备类型**（IoT device type）可能会对各种关键服务的可靠和安全运行产生重大影响。因此，在本文中，我们解决了物联网设备指纹识别问题（problem of IoT device fingerprinting）。我们证明，机器学习技术可用于发现网络中传输流量的物联网设备的类型。该指纹识别**仅使用从加密的**网络流量中提取的特征来执行。

工作的主要贡献如下：

- （i）我们提出了一种新的物联网指纹攻击，即使在设备使用**加密**或**训练集较小**时（即，相对于基线），该攻击也有效。该攻击**不需要手动调整参数**来分段流量。这是使用提出的**新型滑动窗口**技术自主完成的。
- （ii）我们基于IBM Research和Cisco最近收集的真实数据集研究了许多物联网设备的特性。我们证明，尽管广泛采用了传输层加密，但可以导出信息特征来揭示物联网设备的类型。
- （iii）我们对数据集进行了不同的勘探和比较评估测量。

排版：第二节概述了我们的假设、问题陈述、目标和基线的限制。然后，我们详细介绍了在加密流量上使用机器学习的物联网设备指纹识别方法。第四节描述了数据集以及我们的特征分析和选择技术。第五节详细介绍了实验结果和发现。我们在第六节中回顾了当前关于设备指纹的文献。第七节总结了本文。

# 设备指纹识别（Device Fingerprinting）的问题定义和基线方法

## 问题定义

目标是将每个加密的流量的**流**映射到可能产生它的设备类型。在这项工作中，我们将研究范围限制在D有限且所有设备的元信息可用的情况下。

主要目标是寻找一种ML分类模型，该模型在使用其最佳调整参数进行训练和基准测试后，能够识别任何未看到的加密流量Pdi的相应设备di，从而识别出∀di∈D。实现这一目标的第一步是在运行时提取特征。第二步是构建一个分类器，该分类器将这些特征作为输入并进行分类，以推断设备的类型。

## 基线方法

新南威尔士大学的研究。

这种方法的缺点有两个：（1）它依赖于手工参数调整，并且不像我们在这项工作中所做的那样自动分割流量。（2） 它仅适用于大型训练数据集（即。，≥ 总交通量的90%）。对于较小的训练数据集（小于总流量的90%），这种方法对噪声非常敏感，并且很难找到最佳估计量，即允许基线进行最佳训练的有效参数集。

对于流量分割（traffic segmentation），基线方法中采用了滑动窗口的概念。它的主要优点是可以很容易地将过去处理的交通活动与最近处理的交通事件区分开来。

虽然这种方法简单有效，但也有一些缺点：第一个缺点在于l和r的参数化。在基线方法中，这两个参数在设计时是固定的，在运行时不会改变。第二，并非每个窗口中的所有流量都必然相关-如果我们考虑例如wj+r的情况，其中不存在相关的流量活动。此外，一些设备可能具有很长的流量序列（例如，Pd1），其使用小窗口进行跟踪变得非常困难。

# 使用ML加密流量的物联网设备指纹

包括以下步骤：

（i）基于扩展滑动窗口技术的动态分割（a dynamic segmentation based on an extended sliding window technique）；

（ii）分析加密流量以提取相关特征；

（iii）研究各种分类算法。

## 扩展滑动窗技术

提出了滑动窗口技术的改进，根据相关流量的发生情况，使其长度在运行时自适应。

它的基本思想大致是：“当相关的交通活动变长时，窗口将自动增长；否则，窗口将缩小以丢弃不相关的交通。它不按r移动，而是使用下一个不相交的相关活动来移动交通”。

```
s basic idea is roughly: “when-ever relevant traffic activities are becoming long, the window will grow autonomously; otherwise it will shrink to discard irrelevant traffic. Instead of shifting by r, it uses the next disjoint relevant activities to move over traffic”.
```

然后将算法分为两个阶段，第一个阶段类似于原始方法，但我们现在使用重叠分析**将流量划分为不相交活动**的片段。对于每个片段j，我们确定开始和结束时间，并成对存储这些值(t′j, t′′j)在列表中T，然后算法进入第二阶段，在该阶段中，它迭代T自主调整l和r.它创建一个时态窗口wt′j↦t′′j对于每个元素(t′j,t′′j)∈T长度和移位分别使用公式 2 和 3 自主计算。

![](../../../typora pictures/微信截图_20221222154536.png)

所以，窗口的长就是不相交活动片段的长度；窗口的位移就是从当前这个不相交活动移动到下一个不相交活动处。

![](../../../typora pictures/微信截图_20221222155038.png)

## 特征提取

我们寻找时间不变的特征，或者至少在相当长的时间内不会发生任何变化。一种简单的技术是考虑数据包的有效载荷。然而，如前所述，对于加密流量，我们无法检查有效负载内容。因此，我们**仅使用以下两种技术**从数据包报头中提取特征：

- 基于主导协议分析的基本特征

  确定了可用于提取特征的一组主要协议，这些特征隐含地揭示了所考虑设备的独特特性。本研究中考虑的一组特征包括**主要协议类型、端口间隔、数据包大小、数据包数量、可用性时间、到达间隔时间、累积计数等**。

  ```
  the types of dominant protocols, port intervals, packet size, packet quantity, availability time, inter-arrival time, cumulative count, etc.
  ```

- 基于统计流量率的衍生特征

  将基本特征流转换为统计分布来获得特征。该集合包括**最小值、最大值、平均值、中值、标准差、方差等**。

  ```
  minimum, maximum, mean, median, standard deviation, variance, etc.
  ```

## 机器学习算法

- KNN
- 非线性SVM
- RF
- AB
- ET

在当前的研究中，我们倾向于使用集成方法的算法，因为它们的分类器通常比其他单个分类器获得更好的精度，所有其他参数均设置为scikit 0.19.1版提供的默认值。

# 数据集

使用的数据集[19]**来自新南威尔士大学**[20]，[21]，IBM Research和Cisco Systems最近在[7]中使用了相同的数据集

![Table I:- List of iot devices in the smart campus environment](https://ieeexplore.ieee.org/mediastore_new/IEEE/content/media/8870904/8885408/8885429/1570507306-table-1-source-small.gif)

## 特征分析数据集

### 主导协议分析（DPA）

我们这里的重点是应用层协议，如图4所示，在这里我们检查了TCP/UDP数据包最常用的目标端口。我们发现，端口号分布在所有数据包中并不均匀。一些设备倾向于使用众所周知的端口发送比其他端口更多的数据包。因此，我们决定将端口分组为范围：1）系统端口从0到1023，2）注册端口从1024到49151，最后3）动态端口从49152到65535。

大约72%的数据包是通过该端口发送的。这意味着大多数数据包内容都是加密的，因此我们不能仅依靠从有效载荷推断敏感数据。第二个主要端口是TCP端口80，代表HTTP，占TCP流量的27%。我们的分析还显示，TCP端口853/53、445、548和22（分别表示DNS、SMB、AFP和SSH）存在于其他使用的协议中。远离TCP，我们也可以观察到系统端口范围内的UDP数据包。它们基本上与表示SSDP协议的UDP端口1900相关联。此协议用于通告网络中设备的存在，并用于发现新服务。它占UDP数据包的20%。DNS和NTP分组也分别使用端口53/853和123在UDP分组中可见。

### 流量率统计分析

HP打印机、iHome交换机和Netatmo Welcome的到达间隔时间分别为90、60和20秒。注意，这种到达间隔时间的出现出现的概率大于70%。

# 实验

我们开发了一个设备指纹识别框架，允许在运行时，在基准测试过程中考虑不同的分类器和参数。

# 结论

我们的物联网指纹识别方法在精神上与Sivanathan等人[7]提出的工作相似，被认为是本文的基线。它涉及主要的协议分析功能集、静态分段和射频分类。这种方法的缺点是双重的：[（1）](https://ieeexplore.ieee.org/abstract/document/#deqn1)它依赖于手工制作的参数调整，并且不像我们在这项工作中所做的那样自主地分段流量。（[2）](https://ieeexplore.ieee.org/abstract/document/#deqn2-3)它仅适用于具有无噪声流量的大型训练数据集（即≥90%）。对于较小的训练数据集（小于 90%），这种方法对噪声非常敏感，并且很难找到最佳估计器。



本文中演示了机器学习技术在加密流量上对物联网设备进行指纹识别的高准确性。我们已经表明，在不需要解密基础流量的情况下，（基本/衍生）DPA功能和自动滑动窗口可以有效地用于揭示物联网设备类型，与基线相比，准确度提高了18.5%。
