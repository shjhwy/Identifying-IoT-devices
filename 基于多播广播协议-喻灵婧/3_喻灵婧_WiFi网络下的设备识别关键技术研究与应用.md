# 摘要

特点：被动、局域网协议（多播广播），以DHCP协议和服务发现协议为主

WDMTI：提取DHCP的特征，使用分层狄利克雷过程（HDP）这一模型，该方法的特点在于可以识别申请接入网络的设备的制造商和类型是否是目前已知的，动态识别未知类型的设备，

OWL：所有的广播和多播数据包， 并从这些数据包中提取设备特征，能区分出新类别的设备，通过多视图学习技术，将设备特征建模到六个独立且互补的特征视图中，在此基础上，提出MvWDL模型

对样本进行半自动化的标记，最细可达到三级粒度标签：<制造商、类型和型号>，但注意不是所有样本都标记到这三级，有的样本可能只有制造商和类型。



设备识别任务本质上是分类任务，所以数据集的标签粒度实际上就是设备的识别粒度



论文认为在局域网内做设备识别的意义：

```
一旦有移动设备或者物联网设备通过 WiFi 或者以太网连入到网络中，需要能识别该连入设备的制造商、类型和型号。因为，网络管理员可以根据设备的制造商、类型和型号实施适当的安全防护措施
```

论文中阐述识别新设备的意义：

```
有相当数量的新设备正在释放到市场上。特别是随着物联网的蓬勃发展，新的便携式和可穿戴设备会不断被推出。设备制造商也在不断为传统设备增加无线通信能力，以使设备能便携的连接到互联网。
因此，假设所有制造商和设备类型都在训练数据集中是已知的是不切实际的
```

## 论文的工作

完全被动的方式，避免了主动的缺点

构建了大规模的Wi-Fi设备数据集，提出了半自动化的样本标注方法

证明了多播、广播协议包含充分的设备类别信息，避免了使用点对点流量

HDP能区分出新类别的设备

# 相关工作

早期：单个设备身份的识别（identify）

现在做的：设备类别识别（recognize、classify）

- 主动
  - GTID：会使用主动探测的方式向该设备发送请求包，然后利用该设备所回复的包的时间间隔序列来作为这类设备的指纹
  - ARE：从网站上扒取设备的文本语料库，经过自然语言和数据挖掘等技术的 处理后，形成相关的语料与设备类型的映射规则
- 被动
  - IoT Sentinel 部署在网关上 被动获取设备启动时所产生的流量，并从这些流量中提取特征
  - TMC2018



# 特征提取

1. 设备类别标识符：仅用于样本标注。如MAC前缀；DHCP 协议中的 Host Name 字段和 mDNS 协议响应消息中的 answer names 字段中的内容常常会包含设备名称。

   ```
   只有大约 30% 的设备包含除 MAC 地址以外的设备类别标识符信息。
   ```

   

2. 设备辅助特征：用于训练模型。

   1. 键值对特征，如DHCP 协议中每个选项的选项码都被视为键，选项对应的值即为该选项码健 的值。值可以是离散类型、数字类型或文本类型。
   2. 伪自然语言特征，本文将 mDNS 协议消息中的资源记录（RR：resource record）中的内容都视为伪自然语言特征。将一个设备的所有 RR 字符串作为 设备的 mDNS 协议的特征。
   3. 设备辅助特征，仅用于对本文中的设备识别技术进行实验效果评估。

# 样本集的构建（打标签）过程

主要是对未知标签的设备标注标签的过程

使用设备类别标识符和设备辅助特征（如果存在）以及搜索引擎来标记设备的制造商、 类型和型号。

实现了一种半自动化构建设备训练样本集的方法：

1. 在进行设备类别标注的起始阶段，本文使用表3.2中从高到低的优先级， 手动标记设备的制造商、类型和型号。
2. 以 {Condition => Label} 的形式创建标记规则。{MAC:D-link; HostName:DCS-930LB => {D-link, camera, dlink_camera_dcs-930lb}} 表示当 MAC 地址前缀代表的制造商是 D-link 并且 DHCP 协议中选项码为 12 的 选项（HostName）包含字符串“DCS-930LB”时，设备类别应被标记为 {D-link, camera, dlink_camera_dcs-930lb}。
3. 在人工构建好的标记规则基础上，利用频繁项挖掘技术获取频繁出现的 文本内容与设备类别关系对，构建设备的标记规则知识库。

# WDMTI

使用设备广播的 DHCP 协议数据 包中的特征；

分类算法：HDP

HDP 模型对设备指纹进行分类以识别设备类别或者判断设备是否属于一种 新的设备类别。

## WDMTI的特征

从 DHCP 协议 Request 数据包的选项中提取了 18 个特征。

## HDP模型

本质上是聚类算法。

训练：

使用已标记了制造商和类型的设备训练 样本来训练 HDP 模型。在 HDP 模型的训练阶段，将所有具有制造商和类型标签 的设备指纹用 HDP 模型进行聚类。然后，将指纹簇标记为该簇中大多数设备所 属的制造商和类型。

测试：

HDP 模型会将新进入 WiFi 的设备的指纹归为（1）已标记了设备制造商和 设备类型的指纹簇中，或（2）新指纹簇中。

1. 在（1）中，新设备所属制造商和类 型将从指纹簇的标签继承。
2. 在（2）中，如果确定指纹属于新的指纹簇，WDMTI 就会认为此设备 的制造商和类型目前是未知的。可以进一步人工分析该设备的制造商和类型并 在 WDMTI 中手动添加设备的标签。当新的设备指纹和设备标签被添加到 HDP 模型中时，该模型将被动态地重新训练。



# OWl

使用多视图学习为底层思想来解决设备识别问题。不同种类的广播协议和多播协议的特征自然地组织到相应的视图中，分类模型将基于所有的特征视图的联合来进行优化。

